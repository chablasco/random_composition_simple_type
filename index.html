<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>CB Half Typography Random Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
<script>
let font;
let upperChar, lowerChar;
let upperTempo = 720; // Tempo for updating the top half (ms)
let lowerTempo = 700; // Tempo for updating the bottom half (ms)
let lastUpperChange = 0;
let lastLowerChange = 0;
const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

// Offscreen graphics buffers for the two halves
let upperG, lowerG;
// Set lowerOffset to 0 so that both halves are drawn centered at the same spot.
let lowerOffset = 0;

function preload() {
  // Load the font (ensure "assets/Combine.otf" exists)
  font = loadFont("assets/Combine.otf");
}

function setup() {
  createCanvas(windowWidth, windowHeight);
  textAlign(CENTER, CENTER);

  // Create offscreen graphics buffers matching the canvas size
  upperG = createGraphics(windowWidth, windowHeight);
  lowerG = createGraphics(windowWidth, windowHeight);
  setupGraphics(upperG);
  setupGraphics(lowerG);

  // Initialize with random letters
  upperChar = randomChar();
  lowerChar = randomChar();
}

function draw() {
  background(255); // White background
  
  const now = millis();
  if (now - lastUpperChange > upperTempo) {
    upperChar = randomChar();
    lastUpperChange = now;
  }
  if (now - lastLowerChange > lowerTempo) {
    lowerChar = randomChar();
    lastLowerChange = now;
  }
  
  // Update both offscreen buffers at the same centered position
  updateGraphics(upperG, upperChar, 0);
  updateGraphics(lowerG, lowerChar, lowerOffset);
  
  // Copy the top half from the upper buffer and the bottom half from the lower buffer
  copy(upperG, 0, 0, width, height/2, 0, 0, width, height/2);
  copy(lowerG, 0, height/2, width, height/2, 0, height/2, width, height/2);
}

function updateGraphics(pg, char, offset) {
  pg.background(255);
  pg.fill(0);
  // Draw the letter with its center at (width/2, height/2 + offset)
  pg.text(char, width / 2, height / 2 + offset);
}

function setupGraphics(pg) {
  pg.textAlign(CENTER, CENTER);
  pg.textFont(font);
  pg.textSize(350);
}

function randomChar() {
  return chars.charAt(int(random(chars.length)));
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
  // Recreate offscreen graphics buffers with new dimensions
  upperG = createGraphics(windowWidth, windowHeight);
  lowerG = createGraphics(windowWidth, windowHeight);
  setupGraphics(upperG);
  setupGraphics(lowerG);
}
</script>
</body>
</html>
