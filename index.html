<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Split-Flap Mixed Letters</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
<script>
let font;
let upperChar, lowerChar;
let upperTempo = 320; // Tempo for updating the top half (ms)
let lowerTempo = 300; // Tempo for updating the bottom half (ms)
let lastUpperChange = 0;
let lastLowerChange = 0;
const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

// Offscreen graphics buffers for the two halves
let upperG, lowerG;

function preload() {
  // Load your font (ensure the file exists in the assets folder)
  font = loadFont("assets/Combine.otf");
}

function setup() {
  createCanvas(windowWidth, windowHeight);
  textAlign(CENTER, CENTER);

  // Create offscreen graphics buffers matching the canvas size
  upperG = createGraphics(windowWidth, windowHeight);
  lowerG = createGraphics(windowWidth, windowHeight);
  setupGraphics(upperG);
  setupGraphics(lowerG);

  // Initialize with random letters
  upperChar = randomChar();
  lowerChar = randomChar();
}

function draw() {
  background(255); // White background

  const now = millis();
  if (now - lastUpperChange > upperTempo) {
    upperChar = randomChar();
    lastUpperChange = now;
  }
  if (now - lastLowerChange > lowerTempo) {
    lowerChar = randomChar();
    lastLowerChange = now;
  }

  // Update the offscreen graphics for the upper letter
  upperG.background(255);
  upperG.fill(0);
  upperG.text(upperChar, width / 2, height / 2);

  // Update the offscreen graphics for the lower letter
  lowerG.background(255);
  lowerG.fill(0);
  lowerG.text(lowerChar, width / 2, height / 2);

  // Copy the top half of the upper letter graphics to the main canvas
  copy(upperG, 0, 0, width, height / 2, 0, 0, width, height / 2);

  // Copy the bottom half of the lower letter graphics to the main canvas
  copy(lowerG, 0, height / 2, width, height / 2, 0, height / 2, width, height / 2);
}

// Helper to set common text properties for a p5.Graphics buffer
function setupGraphics(pg) {
  pg.textAlign(CENTER, CENTER);
  pg.textFont(font);
  pg.textSize(350);
}

function randomChar() {
  return chars.charAt(int(random(chars.length)));
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
  // Recreate the offscreen graphics buffers with new dimensions
  upperG = createGraphics(windowWidth, windowHeight);
  lowerG = createGraphics(windowWidth, windowHeight);
  setupGraphics(upperG);
  setupGraphics(lowerG);
}
</script>
</body>
</html>
